$(document).ready(function(){var e="https://content.guardianapis.com/search?section=uk-news&show-fields=headline,thumbnail,body&api-key=cf7bb976-9217-42bb-9cda-5804a5426c25";a(e),fetch("https://api.openweathermap.org/data/2.5/weather?q=Belfast,uk&units=metric&APPID=e293496d1d443a35892e8aa1a44ba9fb").then(e=>e.json()).then(e=>{var t=e.name,a=e.main.temp,n=e.main.temp_min,r=e.main.temp_max,i=e.weather[0].description,o=e.weather[0].icon,s="https://openweathermap.org/img/w/"+o+".png",l=string=i.charAt(0).toUpperCase()+i.substr(1,i.length).toLowerCase();$("#name").empty(),$("#temp").empty(),$("#min").empty(),$("#max").empty(),$("#desc").empty(),$(".inputValue").val(""),$("#name").append(t),$("#temp").append("It is currently "+a+"&#8451; in "+t+". |"),$("#min").append(" The minimum temperature today is "+n+"&#8451;. |"),$("#max").append(" The maximum temperature today is "+r+"&#8451;. |"),$("#desc").append(" Weather description: "+l+"."),$("#icon").attr("src",s)}),$("#submitCity").on("click",function(){var e=document.querySelector(".inputValue");fetch("https://api.openweathermap.org/data/2.5/weather?q="+e.value+"&units=metric&APPID=e293496d1d443a35892e8aa1a44ba9fb").then(e=>e.json()).then(e=>{var t=e.name,a=e.main.temp,n=e.main.temp_min,r=e.main.temp_max,i=e.weather[0].description,o=e.weather[0].icon,s="https://openweathermap.org/img/w/"+o+".png",l=string=i.charAt(0).toUpperCase()+i.substr(1,i.length).toLowerCase();$("#name").empty(),$("#temp").empty(),$("#min").empty(),$("#max").empty(),$("#desc").empty(),$(".inputValue").val(""),$("#name").append(t),$("#temp").append("It is currently "+a+"&#8451; in "+t+". |"),$("#min").append(" The minimum temperature today is "+n+"&#8451;. |"),$("#max").append(" The maximum temperature today is "+r+"&#8451;. |"),$("#desc").append(" Weather description: "+l+"."),$("#icon").attr("src",s)}).catch(e=>alert("Error: city not found"))});var t={};function a(e){$.ajax({url:e,method:"GET",dataType:"json",success:function(e){var a="";for(var n in t=e.response.results)date=moment(t[n].webPublicationDate).format("MMM Do YYYY, h:mm a"),$(".container .row").append(a+=`\n            <div class='col-md-4'> <div class='card mb-3' style='width:22rem; height:27rem;'> <img class='card-img-top' src="${t[n].fields.thumbnail}" alt='Article thumbnail'></img><div class='card-body d-flex flex-column'><h5 class='card-title'>${t[n].fields.headline}</h5><h6 class='card-subtitle mb-2 text-muted'>`+date+`</h6><a href='${t[n].webUrl}' class='mt-auto btn btn-primary viewArticle'>View article</a></div></div></div>\n            `);if(localStorage.setItem("offline",JSON.stringify(t)),""!==a)$(".container .row").html(a);else{$(".container .row").empty();let e="Sorry, no articles could be found.";$(".container .row").append(e)}},error:function(){$(".container .row").append("Error")}})}$("#searchbtn").on("click",function(e){e.preventDefault();let a=$("#searchquery").val();if(!0===navigator.onLine){let e="https://content.guardianapis.com/search?q="+a+"&show-fields=headline,thumbnail,body&api-key=cf7bb976-9217-42bb-9cda-5804a5426c25";""!==a?$.ajax({url:e,method:"GET",dataType:"jsonp",success:function(e){var a="";t=e.response.results;for(var n=0;n<t.length;n++)date=moment(t[n].webPublicationDate).format("MMM Do YYYY, h:mm a"),$(".container .returns").empty(),$(".container .row").append(a+=`\n                <div class='col-sm-4 col-md-4 col-xs-12'> <div class='card mb-3' style='width:22rem; height:27rem;'> <img class='card-img-top img-responsive' src="${t[n].fields.thumbnail}" alt='Article thumbnail'></img><div class='card-body d-flex flex-column'><h5 class='card-title'>${t[n].fields.headline}</h5><h6 class='card-subtitle mb-2 text-muted'>`+date+`</h6><a href='${t[n].webUrl}' class='mt-auto btn btn-primary viewArticle'>View article</a></div></div></div></div>\n                `);if(""!==a){$(".container .returns").empty(),$(".container .row").empty();var r=$(a).length;$(".container .row").html(a),$(".container .returns").append("Your search returned "+r+" articles.")}else{$(".container .row").empty();let e="Sorry, no articles match your search. Try searching for something else.";$(".container .row").append(e)}},error:function(){$(".container .row").append("Error")}}):($(".container .row").empty(),$(".container .row").append("Please enter a valid search."))}else{data=JSON.parse(localStorage.getItem("offline")),offline=[];let e="";var n=0;for(var r in a=a.toUpperCase(),data){if(check=data[r].fields.headline.toUpperCase(),check.indexOf(a)>=0&&(j=0,offline.push(data[r]),j++,oDate=moment(data[r].webPublicationDate).format("MMM Do YYYY, h:mm a"),oHeadline=data[r].fields.headline,oThumbnail=data[r].fields.thumbnail,oUrl=data[r].webUrl,oBody=data[r].fields.body,e+=`<div class='col-md-4'> <div class='card mb-3' style='width:22rem; height:27rem;'> <img class='card-img-top' src="${oThumbnail}" alt='Article thumbnail'></img><div class='card-body d-flex flex-column'><h5 class='card-title'>${oHeadline}</h5><h6 class='card-subtitle mb-2 text-muted'>`+oDate+`</h6><a href='${oUrl}' class='mt-auto btn btn-primary viewArticle'>View article</a></div></div></div>\n        `,n++),""!==e)$(".container .returns").empty(),$(".container .row").empty(),$(".container .row").html(e),$(".container .returns").append("Your offline search returned "+n+" articles.");else{$(".container .row").empty();let e="Sorry, no articles match your search. Try searching for something else.";$(".container .row").append(e)}t=offline}}$("#searchquery").val("")}),$(".nav-link").on("click",function(){$(".nav-link").parent("li").removeClass("active"),$(this).parent("li").addClass("active");var e="https://content.guardianapis.com/search?section="+$(this).attr("href").slice(1)+"&show-fields=headline,thumbnail,body&api-key=cf7bb976-9217-42bb-9cda-5804a5426c25";$(".container .returns").empty(),a(e)}),$(".navbar-brand").on("click",function(){$(".container .returns").empty(),a(e)}),$(document).on("click",".viewArticle",function(e){e.preventDefault();var a=$(this).index(".viewArticle");title=t[a].fields.headline,content=t[a].fields.body,image=t[a].fields.thumbnail,$("#myModal").modal("show"),$(".modal-title").html(title),$(".modal-body img").attr("src",image),$(".modal-body p").html(content)});var n=new Tour({smartPlacement:!0,keyboard:!0,autoscroll:!0,backdrop:!0,storage:!1,template:"<div class='popover tour'> <div class='arrow'></div><h3 class='popover-title'></h3><div class='popover-content'></div><div class='popover-navigation'><button class='btn btn-light' data-role='prev'>« Prev</button><span data-role='separator'>|</span><button class='btn btn-light' data-role='next'>Next »</button></div><button class='btn btn-default btn-primary' style='background-color:#32a852; color:#fff; float: right;' data-role='end'>End tour</button></div>",steps:[{element:".navbar-brand",title:"Home",content:"Clicking here will take you back to the homepage."},{element:".nav-tabs",title:"Categories",content:"Clicking on any of these tabs will show you news articles related to their title."},{element:"#searchquery",title:"Search",content:"Use this to search for a particular topic or keyword."}]});n.init(),$("#help").on("click",function(){n.start()}),$("#topHeadlinesCarousel").carousel({interval:7e3}),$.get("https://content.guardianapis.com/search?show-fields=thumbnail,headline,body,lastModified,trailText&api-key=cf7bb976-9217-42bb-9cda-5804a5426c25",function(e){for(var t=0;t<5;t++)cThumbnail=e.response.results[t].fields.thumbnail,cHeadline=e.response.results[t].fields.headline,cBlurb=e.response.results[t].fields.trailText,cLastModified=e.response.results[t].fields.lastModified,cBody=e.response.results[t].fields.lastModified,$(".headline:eq("+t+")").text(cHeadline),$(".blurb:eq("+t+")").text(cBlurb),$(".carousel-item img:eq("+t+")").attr("src",cThumbnail);$(document).on("click",".readArticle",function(t){t.preventDefault(),topNews=e.response.results;var a=$(this).index(".readArticle");title=topNews[a].fields.headline,content=topNews[a].fields.body,image=topNews[a].fields.thumbnail,$("#myModal").modal("show"),$(".modal-title").html(title),$(".modal-body img").attr("src",image),$(".modal-body p").html(content)})});var r=document.createElement("script"),i=document.getElementsByTagName("script")[0];r.async=!0,r.src=url,i.parentNode.insertBefore(r,i)});